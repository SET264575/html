<html>
  <head>
    <title>
      MDM
    </title>
    <style>
      p {
        color: red;
      }
      table,td {
        vertical-align: top;
        border: 1px solid black;
        border-collapse:  collapse;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <table>
      <tr>
        <td>Complexity of Problems Addressed</td>
        <td>Data</td>
        <td>Risk</td>
      </tr>
      <tr>
        <td>
          <h4>Straightforward</h4>
          <input type = "checkbox" onchange = "copytext()" id = "11"/>
          <label for="11">1 self-limited or minor problem</label><br>
          <h4>Low</h4>
          <input type = "checkbox" onchange = "copytext()" id = "12"/>
          <label for="12">2 self-limited or minor problems</label><br>

          <input type = "checkbox" onchange = "copytext()" id = "13">
          <label for="13">1 stable, chronic illness</label><br>

          <input type = "checkbox" onchange = "copytext()" id = "14">
          <label for="14">1 stable, acute illness</label><br>

          <input type = "checkbox" onchange = "copytext()" id = "15">
          <label for="15">1 stable, acute illness</label><br>
          <h4>Moderate</h4>
          <input type = "checkbox" onchange = "copytext()" id = "17">
          <label for="17">1 or more chronic illnesses with exacerbation, progression or side effects of treatment</label><br>

          <input type = "checkbox" onchange = "copytext()" id = "18">
          <label for="18">2 or more stable, chronic illnesses </label><br>

          <input type = "checkbox" onchange = "copytext()" id = "19">
          <label for="19">1 undiagnosed new problem with uncertain prognosis</label><br>

          <input type = "checkbox" onchange = "copytext()" id = "20">
          <label for="20"><b>1 acute illness with systemic systems</b></label><br>

          <input type = "checkbox" onchange = "copytext()" id = "21">
          <label for="21">1 acute, complicated injury</label><br>
          
          <h4>High</h4>
          
          <input type = "checkbox" onchange = "copytext()" id = "22">
          <label for="22">1 or more chronic illnesses with severe exacerbation, progression or side effects of treatment </label><br>

          <input type = "checkbox" onchange = "copytext()" id = "23">
          <label for="23">1 acute or chronic illness or injury that poses a threat to life or bodily function</label><br>

        </td>
        <td>
          <input type = "checkbox" onchange = "copytext()" id = "111">
          <label for="111">Review of prior external notes</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "112">
          <label for="112">Review of results of each unique test</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "113">
          <label for="113">Ordering each unique test</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "114">
          <label for="114">Assessment required an independent historian</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "115">
          <label for="115">Independent interpretation of tests</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "116">
          <label for="116">Discussion of management or test interpretation</label><br>
        </td>
        <td>
          <h4>Moderate</h4>
          <input type = "checkbox" onchange = "copytext()" id = "211">
          <label for="211">Drugs prescribed</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "212">
          <label for="212">Decision regarding minor surgery with identified patient or procedure risk factors</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "213">
          <label for="213">Decision regarding elective major surgery without identified risk factors</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "214">
          <label for="214">Diagnosis or treatment significantly limited by social determinants of health</label><br>
          <h4>High</h4>
          <input type = "checkbox" onchange = "copytext()" id = "215">
          <label for="215">Drug therapy requiring intensive monitoring for toxicity</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "216">
          <label for="216">Decision regarding elective major surgery with identified patient or procedure risk factors</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "217">
          <label for="217">Decision regarding emergency major surgery</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "218">
          <label for="218">Decision regarding hospitalization or escalation of hospital-level care</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "219">
          <label for="219">Decision not to resuscitate or to de-escalate care because of poor prognosis</label><br>
          <input type = "checkbox" onchange = "copytext()" id = "220">
          <label for="220">Parenteral controlled substances</label><br>
        </td>
      </tr>
      <tr>
        <td><p id = "COPA"></p></td>
        <td><p id = "DATA"></p></td>
        <td><p id = "RISK"></p></td>
      </tr>
    </table>
    <input type="text" list="cars" id = "in" autofocus>
    <datalist id="cars">
    </datalist>
    <!--button onclick="ddx('chest pain')">Submit</button><br-->
    <h3>Differential Diagnosis</h3>
    <pre id = "ddx"></pre><br>
    <h3>Dictate in MDM</h3>
    <pre id="MDM"></pre>
    <script src="..\Code\searchProblems.js"></script>
    <script>
      function copytext(){
        var id = [11,12,13,14,15,17,18,19,20,21,22,23,111,112,113,114,115,116,211,212,213,214,215,216,217,218,219,220];
        const cb = {};
        var copa = '';
        var data = '';
        var risk = '';
        var dictationList = [];
        
        for (let i = 0; i<id.length; i++) {
          console.log(id[i]);
          cb[id[i]] = document.getElementById(String(id[i])).checked;
        }
        
        if (cb[17]) {
          dictationList.push('Describe presentation, including chronic with exacerbation, progression or side effects of treatment');
        }
        
        if (cb[18]) {
          dictationList.push('Describe presentation, including 2 or more stable, chronic illnesses');
        }
        
        if (cb[19]) {
          dictationList.push('Describe presentation, including undiagnosed new problem with uncertain prognosis');
        }
        
        if (cb[20]) {
          dictationList.push('Describe presentation, including systemic symptoms');
        }
        
        if (cb[21]) {
          dictationList.push('Describe presentation, including why injury was complicated');
        }
        
        if (cb[23]) {
          dictationList.push('Describe presentation, including why illness or injury posed threat to life or bodily function');
        }
        
        if (cb[22]) {
          dictationList.push('Describe presentation, including why acute new illness or acute exacerbation of existing illness.  Describe why severe.');
        }
        
        dictationList.push('Discuss differential diagnoses');
        
        if (cb[111]) {
          dictationList.push('Reviewed prior external notes');
        }
        
        if (cb[112]) {
          dictationList.push('Reviewed results of the tests documented in this note.');
        }
        
        if (cb[113]) {
          dictationList.push('Ordered results of the tests documented in this note.');
        }
        
        if (cb[114]) {
          dictationList.push('Independent historians I obtained history from');
        }
        
        if (cb[115]) {
          dictationList.push('My independent interpretation of CXR/CT/EKG showed ');
        }
        
        if (cb[116]) {
           dictationList.push('I discussed the situation with ... who ');
        }
        
        if (cb[211]) {
          dictationList.push('I prescribed...');
        }
                
        if (cb[212]) {
          dictationList.push('The patient needs minor surgery, identifiable risks.  Discussed with patient');
        }
        
        if (cb[213]) {
          dictationList.push('The patient needs elective major surgery.  Discussed with patient');
        }
                
        if (cb[214]) {
          dictationList.push('Diagnosis or treatment significantly limited by social determinants of health (homelessness, lack of money, food insecurity)');
        }
        
        if (cb[215]) {
          dictationList.push('Drug therapy given which required intensive monitoring for toxicity');
        }  
        
        if (cb[216]) {
          dictationList.push('Patient needs elective major surgery, identifiable risks.  Discussed with patient.');
        }
        
        if (cb[217]) {
          dictationList.push('Patient needs emergency major surgery');
        }      
        
        if (cb[218]) {
          dictationList.push('I discussed admission with the patient and family...');
        }
               
        if (cb[219]) {
          dictationList.push('Due to poor prognosis, discussed DNR, de-escalation of care with patient and family. Results...');
        }
        
        if (cb[220]) {
          dictationList.push('Parenteral controlled substances given');
        }
        
        
        
        if (cb[11] || cb[12] || cb[13] || cb[14] || cb[15] ) {
          copa = 'Low';
        }
        if ( cb[17] || cb[18] || cb[19] || cb[20] || cb[21]) {
          copa = 'Moderate';
        }
        if (cb[22] || cb[23]) {
          copa = 'High';
        }
        
        var cat1 = (cb[111]?1:0) + (cb[112]?1:0) + (cb[113]?1:0) + (cb[114]?1:0);
        
        if ((cat1 >= 3) || cb[115] || cb[116]) {
          data = "Moderate";
        }
        if ( (((cat1 >=3)?1:0) + (cb[115]?1:0) +(cb[116]?1:0)) >=2) {
          data = "High";
        }
        
        if (cb[211] || cb[212] || cb[213] || cb[214]) {
          risk = 'Moderate';
        }
        
        if (cb[215] || cb[216] || cb[217] || cb[218] || cb[219] || cb[220]) {
          risk = 'High';
        }
        
        document.getElementById('COPA').innerHTML = copa;
        document.getElementById('DATA').innerHTML = data;
        document.getElementById('RISK').innerHTML = risk;
        var s = "<ul>";
        for (let i = 0; i<dictationList.length; i++) {
          s = s + '<li>'+dictationList[i]+'</li>';
        }
        s = s + '</ul>';
        document.getElementById('MDM').innerHTML = s;
          
      }
      
      function ddx(cc){
        const ddx = {};
        var t="";
        ddx['chest pain'] = ['ACS','PE','aortic dissection','pneumonia','chest wall pain','GERD'];
        ddx['dyspnea'] = ['pneumonia','PE','COPD exacerbation','asthma exacerbation','pneumothorax'];
        ddx['cough'] = ['pneumonia','bronchitis','foreign body aspiration','URI'];
        ddx['headache'] = ['migraine','tension headache','subarachnoid hemorrhage','brain tumor'];
        ddx['unilateral weakness'] = ['stroke','TIA','conversion disorder','seizure','hypoglycemia'];
        ddx['abdominal pain'] = ['pancreatitis','cholecystitis','gastritis','peptic ulcer','bowel perforation'];
        for (let i = 0; i<ddx[cc].length; i++){
          t = t+ ddx[cc][i]+'\n';
        }
        document.getElementById('ddx').innerHTML = t;
      }
        
    </script>
  </body>
</html>
        
        
        
