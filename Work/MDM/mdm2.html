<!--
ddx selected
radiobuttons on top
data review buttons not displaying text
independent review as buttons
independent clinician documented button
risk strat tool
shared decision making buttons
de-escalation - buttons to text
social determinants of health buttons without name or id?


-->

<html>
  <head>
    <!--link rel="stylesheet" ahref="mdm.css"-->
    <style>
      .header {
        background-color: #f2f2f2;
        width: 100%;
        height: 200px;
        position: fixed;
        top: 0;
        left: 0;
      }
      
      .main {
        margin-top: 310px;
      }
      
      .collapsible {
        background-color: lightskyblue;
        color: #444;
        cursor: pointer;
        padding: 18px;
        width: 100%;
        border: none;
        text-align: left;
        outline: none;
        font-size: 1em;
        font-family: Arial;
      }

      /* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
      .active, .collapsible:hover {
        background-color: deepskyblue;
      }

      /* Style the collapsible content. Note: hidden by default */
      .content {
        padding: 0 18px;
        display: none;
        overflow: hidden;
        margin: 20px;
        background-color: white;
      }
      
      .choicebutton {
        height: 40px;
        background-color: lightgray;
        border-radius: 5px;
        checked: false;
      }
      
      .choicebutton checked {
        background-color: lightgreen;
      }
      
      .choicebutton:hover {
        background-color: lightgreen;
      }
      
      .headingbutton {
        background-color:  deepskyblue;
        font-family: Arial;
        font-size: 1em;
      }
      
      .subheadingbutton {
        background-color:  lightskyblue;;
        font-family: Arial;
        font-size: 1em;
        margin-left: 30px;
        margin-right: 30px;
      }
      
      .show {
        display: block;
      }
      
      h3 { 
        text-align: center;
      }
      
      h4 {
        margin-left: 20px;
        color: blue;
      }
      h5 {
        margin-left: 30px;
        color: purple;
      }
      input {
        margin-left: 40px;
      }
      
      iframe {
        width: 100%;
        height: 700px;
        border: none;
      }
      
      textarea {
        width: 90%;
        height: 100px;
        border: 1px solid black;
        margin: auto;
        display: block;
      }
      
      .radiobutton {
        list-style-type: none;
        margin: 25px 0 0 0;
        text-align: center;
        padding: 0;
      }

      .radiobutton li {
        float: left;
        margin: 0 5px 0 0;
        width: 300px;
        height: 50px;
        position: relative;
      }

      .radiobutton label,
      .radiobutton input {
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: lightgray;
      }

      .radiobutton input[type="radio"] {
        opacity: 0.01;
        ssdfadzz-index: 100;
      }

      .radiobutton input[type="radio"]:checked+label,
      .Checked+label {
        background: lightgreen;
      }
      
     .radiobutton input[type="checkbox"] {
        opacity: 0.01;
        ssdfadzz-index: 100;
      }

      .radiobutton input[type="checkbox"]:checked+label,
      .Checked+label {
        background: lightgreen;
      }

      .radiobutton label {
        padding: 5px;
        border: 1px solid #CCC;
        border-radius: 5px;
        cursor: pointer;
        z-index: 90;
      }

      .radiobutton label:hover {
        background-color:  gray;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h3>The following text has been copied to the clipboard and is ready to be pasted into your document.</h3>
      <textarea id="text"></textarea>
    </div>

    <div class="main">
      <button type="button" class="collapsible headingbutton">Patient Presentation</button>
      <div class="content show" id = "div-ptpresentation">
        <ul class="radiobutton">
          <li>
        <input type = "checkbox" id = "presentation1" class = "choicebutton" onclick="check(this.id)"><label for = "presentation1">Data reviewed from external sources</label>    <br></li>
      <li>
        <input type = "checkbox" id = "presentation2" class = "choicebutton" onclick="check(this.id)"><label for = "presentation2">Additional historian required</label><br></li>
  </ul>
      </div><br><br>

      <button type="button" class="collapsible headingbutton">Differential Diagnosis</button>
        
      <div class="content show" id = "div-ddx">
        <button class="sxbutton" onclick="showDDX('ddx-abdpain')">Abdominal pain</button>
        <button class="sxbutton" onclick="showDDX('ddx-chestpain')">Chest pain</button>
        <button class="sxbutton" onclick="showDDX('ddx-dyspnea')">Dyspnea</button>
        <button class="sxbutton" onclick="showDDX('ddx-headache')">Headache</button>
        <button class="sxbutton" onclick="showDDX('ddx-pelvicpain')">Pelvic pain</button>
        
        <div class="radiobutton">
          <div class="content" name = "sx" id = "ddx-abdpain">
            <!--button class="ddxbutton" id="ddx-selectallabdpain" onclick="check('ddx-appendicitis','ddx-cholecystitis','ddx-diverticulitis','ddx-pancreatitis','ddx-MI'>Select All</button-->
            <input type = "checkbox"  class="ddxbutton" name = "ddx-abdpain" id="ddx-appendicitis" onclick="check(this.id)" value = "appendicitis"><label for="ddx-appendicitis">Appendicitis</label>
            <input type = "checkbox"  class="ddxbutton" name = "ddx-abdpain" id="ddx-cholecystitis" onclick="check(this.id)" value = "cholecystitis"><label for = "ddx-cholecystitis">Cholecystitis</label>
            <input type = "checkbox"  class="ddxbutton" name = "ddx-abdpain" id="ddx-diverticulitis" onclick="check(this.id)" value = "diverticulitis"><label for = "ddx-diverticulitis">Diverticulitis</label>
            <input type = "checkbox"  class="ddxbutton" name = "ddx-abdpain" id="ddx-pancreatitis" onclick="check(this.id)" value = "pancreatitis"><label for = "ddx-pancreatitis">Pancreatitis</label>
            <input type = "checkbox"  class="ddxbutton" name = "ddx-abdpain" id="ddx-MI" onclick="check(this.id)" value = "MI"><label for = "ddx-MI">MI</label>
          </div>

          <div class = "content" name = "sx"  id = "ddx-chestpain">
            <button class="ddxbutton" name = "ddx-chestpain" id="ddx-acs" onclick="check(this.id)" value = "acute coronary syndrome">ACS</button>
            <button class="ddxbutton" name = "ddx-chestpain" id="ddx-pe" onclick="check(this.id)" value = "pulmonary embolism">PE</button>
            <button class="ddxbutton" name = "ddx-chestpain" id="ddx-aorticdissection" onclick="check(this.id)" value = "aortic dissection">Aortic dissection</button>
            <button class="ddxbutton" name = "ddx-chestpain" id="ddx-pneumothorax" onclick="check(this.id)" value = "pneumothorax">Pneumothorax</button>
            <button class="ddxbutton" name = "ddx-chestpain" id="ddx-pneumonia" onclick="check(this.id)" value = "pneumonia">Pneumonia</button>
          </div>

          <div class = "content" name = "sx"  id = "ddx-headache">
            <button class="ddxbutton" name = "ddx-headache" id="ddx-pneumonia" onclick="check(this.id)" value = "subarachnoid hemorrhage">Subarachnoid hemorrhage</button>
            <button class="ddxbutton" name = "ddx-headache" id="ddx-pneumonia" onclick="check(this.id)" value = "brain tumor">Brain tumor</button>
            <button class="ddxbutton" name = "ddx-headache" id="ddx-pneumonia" onclick="check(this.id)" value = "migraine headache">Migraine headache</button>
            <button class="ddxbutton" name = "ddx-headache" id="ddx-pneumonia" onclick="check(this.id)" value = "meningitis">Meningitis</button>
            <button class="ddxbutton" name = "ddx-headache" id="ddx-pneumonia" onclick="check(this.id)" value = "subdural hematoma">Subdural hematoma</button>
          </div>

          <div class = "content" name = "sx"  id = "ddx-pelvicpain">
            <button class="ddxbutton" name = "ddx-pelvicpain" id="ddx-ectopic" onclick="check(this.id)" value = "ectopic pregnancy">ectopic pregnancy</button>
            <button class="ddxbutton" name = "ddx-pelvicpain" id="ddx-torsion" onclick="check(this.id)" value = "ovarian torsion">ovarian torsion</button>
            <button class="ddxbutton" name = "ddx-pelvicpain" id="ddx-ovariancyst" onclick="check(this.id)" value = "ovarian cyst">ovarian cyst/button>
            <button class="ddxbutton" name = "ddx-pelvicpain" id="ddx-pid" onclick="check(this.id)" value = "pelvic inflammatory disease">PID</button>
            <button class="ddxbutton" name = "ddx-pelvicpain" id="ddx-appendicitis2" onclick="check(this.id)" value = "appendicitis">appendicitis</button>
          </div>
          </div>
        
     </div><br><br>

      <button type="button" class="collapsible">Data Review</button>
      <div class="content show" id = "div-datareview">
        <h4>Tests ordered and reviewed:<h4>
          <ul class='radiobutton'>
          <li><input type = "radio" class="choicebutton" id = "datablood" name = "testsordered" value = "blood tests" onclick="check(this.id)"/><label>Blood tests</label></li>
          <li><input type = "radio"  class="choicebutton" id = "dataua" name = "testsordered" value = "urine tests" onclick="check(this.id)"/><label>Urinalysis</label></li>
          <li><input type = "radio"  class="choicebutton" id = "dataekg" name = "testsordered" value = "EKG" onclick="check(this.id)"/><label>EKG</label></li>
          <li><input type = "radio"  class="choicebutton" id = "dataimaging" name = "testsordered" value = "imaging" onclick="check(this.id)"/><label>Imaging</label></li>
          <br>
          </ul>
          
        <input type = "radio"  class="choicebutton" onclick="check(this.id)"><label>Testing was performed to help rule out these serious or life-threatening problems.</label><br>
        <input type = "radio"  class="choicebutton" onclick="check(this.id)"><label>Laboratory tests were unremarkable.</label><br>
        <input type = "radio"  class="choicebutton" onclick="check(this.id)"><label>Testing was not supportive of any serious or life-threatening problems.</label><br>
      </div><br><br>

      <button type="button" class="collapsible headingbutton">Independent Review of Studies</button>
      <div class="content" id = "div-independent">
        <button type = "button" class="collapsible subheadingbutton">Independent review of the EKG</button>
        <div class="content">
          <ul class="radiobutton">
              <li><input type= "radio"  class = "choicebutton" name = "EKG" onclick="check(this.id)" value="is documented in this note.">Documented</input><br></li>
              <li><input type = "radio"  class = "choicebutton" name = "EKG" onclick="check(this.id)" value="shows the EKG is normal.">Normal.</input><br></li>
              <li><input type = "radio"  class = "choicebutton" name = "EKG" onclick="check(this.id)" value = "shows the EKG is nonspecific for ACS.">Nonspecific for ACS.</input><br></li>
              <li><input type = "radio"  class = "choicebutton" name = "EKG" onclick="check(this.id)" value = "shows the EKG is concerning for ACS.">Concerning for ACS.</input><br></li>
              <li><input type = "radio"  class = "choicebutton" name = "EKG" onclick="check(this.id)" value = "shows STEMI.">STEMI</input><br></li>
              <li><input type = "radio"  class = "choicebutton" name = "EKG" onclick="check(this.id)" value = "shows atrial fibrillation with rapid ventricular rate.">A Fib with RVR</input><br></li>
      
         </ul>

        </div><br><br>
        <button type = "button" class="collapsible subheadingbutton">Independent review of the Chest X-ray</button>
        <div class="content">
          <div class = "radiobutton">
            <li><input type = "button"  class = "choicebutton" name= "cxr">no acute pathology.</input><br></li>
            <li><input type = "button"  class = "choicebutton" name = "cxr">an infiltrate concerning for pneumonia.</input><br></li>
            <li><input type = "button"  class = "choicebutton" name = "cxr">pneumothorax.</input><br></li>
            <li><input type = "button"  class = "choicebutton" name = "cxr">CHF.</input><br></li>
          </div>
        </div><br><br>
        <button type = "button" class="collapsible subheadingbutton">Independent review of the xrays</button>
          <div class="content">
          <input type = "radio" class = "choicebutton" name ="xray">shows no fracture or dislocation.</input><br>
          <input type = "radio" class = "choicebutton" name = "xray">shows a fracture.</input><br>
          <input type = "radio" class = "choicebutton" name = "xray">shows a dislocation.</input><br>
        </div><br><br>
        <button type = "button" class="collapsible subheadingbutton">Independent review of the CT</button>
        <div class="content">
          <input type = "radio" class = "choicebutton" name = "ct">shows no acute pathology.</input><br>
          <input type = "radio" class = "choicebutton" name = "ct">shows a kidney stone.</input><br>
          <input type = "radio" class = "choicebutton" name = "ct">shows diverticulitis.</input><br>
          <input type = "radio" class = "choicebutton" name = "ct">shows [ct result].</input><br>
        </div><br><br>
      </div><br><br>

      <button type="button" class="collapsible headingbutton">Independent Clinician</button>
      <div class="content show" id = "div-uri1">
        <input type = "checkbox" id="clinician"><label>My discussion with an independent clinician is documented in this note.</label>
      </div><br><br>

      <button type="button" class="collapsible headingbutton">Risk Stratification Tools</button>
      <div class="content" id = "div-tools">
        <!--button class="choicebutton">CHA2DS2-VASc</button>
        <button class="choicebutton">HEART score</button>
        <button class="choicebutton">Wells' criteria for DVT</button-->
        
        <iframe src="master.html" id = "iframe"></iframe>
        
      </div><br><br>

      <button type="button" class="collapsible headingbutton">Disposition</button>
      <div class="content show" id = "div-dispo">
        <button type = "button" class="collapsible subheadingbutton">Shared-decision making</button>
        <div class="content">
          <input type = "checkbox">I discussed the options with the patient who agreed to admisison.</input><br>
          <input type = "checkbox">I have discussed the discharge plan as described below with the patient, who is in agreement with the plan.</input><br>

          <h4>De-escalation of care</h4>
          <button class="choicebutton">DNR</button>
          <button class="choicebutton">DNI</button>
          <button class="choicebutton">Hospice</button>
          <button class="choicebutton">Comfort care</button>
          <button class="choicebutton">No more aggressive treatment than currently being given</button>





  </div><br><br>
   <button type = "button" class="collapsible subheadingbutton">Social determinants of health</button>
        <div class="content">
          <button class="choicebutton" name = "social" value = "homelessness" onclick="check(this.id)">Homelessness</button>
          <button class="choicebutton" name = "social" value = "lack of social support" onclick="check(this.id)">Lack of social support</button>
          <button class="choicebutton" name = "social" value = "food insecurity" onclick="check(this.id)">Food insecurity</button>
          <button class="choicebutton" name = "social" value = "lack of insurance" onclick="check(this.id)">Lack of insurance</button>
          <button class="choicebutton" name = "social" value = "inability to obtain medications" onclick="check(this.id)">Inability to obtain medications</button>
          
          
          
        
  </div><br><br>
   <button type = "button" class="collapsible subheadingbutton">Discharge</button>
        <div class="content">
        <h4>Follow up arrangements</h4>
    <h5>Referral</h5>
          <button class="choicebutton" value = "cardiology" onclick="check(this.id)">Cardiology</button>
          <button class="choicebutton" value = "orthopedics" onclick="check(this.id)">Orthopedics</button>
          <button class="choicebutton" value = "gynecology" onclick="check(this.id)">Gynecology</button>
          <button class="choicebutton"  value = "a new PCP" onclick="check(this.id)">a new PCP</button>
          <button class="choicebutton" value = "endocrinology" onclick="check(this.id)">Endocrinology</button>
          
        <input type = "checkbox">I have filled out a referral form</h4>
    <h5>Outpatient testing</h5>
          <button class="choicebutton" name = "outpt testing" value = "colonoscopy" onclick="check(this.id)">Colonoscopy</button><br>
          <button class="choicebutton" name = "outpt testing" value = "upper endoscopy" onclick="check(this.id)">Upper Endoscopy</button><br>
          <button class="choicebutton" name = "outpt testing" value = "Holter monitor" onclick="check(this.id)">Holter monitor</button><br>
          <button class="choicebutton" name = "outpt testing" value = "stress test" onclick="check(this.id)">Stress test</button><br>
          <button class="choicebutton" name = "outpt testing" value = "EEG" onclick="check(this.id)">EEG</button><br>
          <button class="choicebutton" name = "outpt testing" value = "gallbladder ultrasound" onclick="check(this.id)">Gallbladder US</button><br>
          <button class="choicebutton" name = "outpt testing" value = "pelvic ultrasound" onclick="check(this.id)">Pelvic ultrasound</button><br>
          <button class="choicebutton" name = "outpt testing" value = "CT chest" onclick="check(this.id)">CT chest</button><br>
          <button class="choicebutton" name = "outpt testing" value = "CT abdomen & pelvis" onclick="check(this.id)">CT abdomen & pelvis</button><br>
          <button class="choicebutton" name = "outpt testing" value = "duplex ultrasound of the right leg" onclick="check(this.id)">Duplex ultrasound RIGHT LEG</button><br>
          <button class="choicebutton" name = "outpt testing" value = "duplex ultrasound of the left leg" onclick="check(this.id)">Duplex ultrasound LEFT LEG</button><br>
          <button class="choicebutton" name = "outpt testing" value = "carotid duplex ultrasound" onclick="check(this.id)">Carotid duplex US</button><br>
          <button class="choicebutton" name = "outpt testing" value = "echocardiogram" onclick="check(this.id)">Echo</button><br>
          <button class="choicebutton" name = "outpt testing" value = "[outpatient test]" onclick="check(this.id)">[    ]</button><br>
    
  </div><br><br>
   <button type = "button" class="collapsible subheadingbutton">Admit</button>
        <div class="content">
        <h4>Admit</h4>
        <input type = "checkbox">The decision was made to admit the patient.</input><br>
  </div><br><br>
   <button type = "button" class="collapsible subheadingbutton">Transfer</button>
        <div class="content">
        <input type = "checkbox">The decision was made to transfer the patient due to the need for a higher level of care.  My discussion with the accepting physician is documented elsewhere in this note.</input>
  </div><br><br>
    </div><br><br>
</div>
      <script>
        var coll = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < coll.length; i++) {
          coll[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.display === "block") {
              content.style.display = "none";
            } else {
              content.style.display = "block";
            }
          });
        }    
        
        function showDDX(id) {
          var list = document.getElementsByName('sx');
          for (let i = 0; i<list.length; i++) {
            list[i].style.display = 'none';
          }
          document.getElementById(id).style.display = "block";
          document.getElementById(id).checked = true;
          var list2 = document.getElementsByName(id);
          console.log(list2);
          for (let i = 0; i<list2.length; i++) {
            list2[i].checked = true;
          }
        }
        
        function check(id) {
          console.log(id);
          document.getElementById(id).checked == !document.getElementById(id).checked;
          if (document.getElementById(id).style['background-color'] == 'lightgray') {
            document.getElementById(id).style['background-color'] = 'lightblue';
          }
          else {
            document.getElementById(id).style['background-color'] = 'lightgray';
          }
          var list = document.getElementsByTagName('checked');

          
          var t = "";
          t = t + "[Patient Presentation]\n";
          if (document.getElementById('presentation1').checked) {
            t = t + " Data was reviewed from external sources as documented in the HPI. ";
          }
          if (document.getElementById('presentation2').checked) {
            t = t + "Additional historians were required as documented in the HPI. ";
          }
          t = t + "Differential diagnosis considered included serious or life-threatening conditions including ";
          t = t + combineItemsFromButtons('ddx-abdpain');
          t = t + combineItemsFromButtons('ddx-chestpain');
          t = t + "\n\n";
          t = t + "Data Review:\n";
          t = t + "I ordered and reviewed tests, including ";
          t = t + combineItemsFromButtons('testsordered');
          t = t + ", to help rule out these serious or life-threatening conditions. ";
          t = t + "";
          t =t + "The tests were unremarkable. ";
          t = t + "The tests were not supportive of these conditions. ";
          t = t + "\n\n";
          t = t + "Independent review:";
          t = t + "My independent review of the EKG is ***";
          /* radiobutton result */
          t = t + "My independent review of the chest x-ray ***";
          /* radiobutton results */
          t = t + "My independent review of the xrays ***";
          /* */
          t = t + "My independent review of the CT ***";
          /* */
          t = t + "My discussion was independent clinicians is documented in this note. ";
          t = t + "\n\n";
          t = t + "Risk Stratification: \n";
          var iframe = document.getElementById("iframe");
          var test = iframe.contentWindow.document.getElementById('text').innerHTML;
          t = t + test+"\n";
          t = t + "\n\n";
          t = t + "Disposition:\n ";
          t = t + "I discussed the options with the patient who agreed with admission. ";
          t = t + "Due to the patient's poor prognosis, I discussed de-escalation of care with the patient and/or their surrogates who decided ***";
          if (isAnyChecked('social')){
            t = t + "My decision regarding treatment was affected by social determinants of health including " + combineItemsFromButtons('social');
          }
          if (isAnyChecked('referral')) {
            t = t + "I referred the patient to " + combineItemsFromButtons('referral') + '.';
          }
          if (isAnyChecked('outpatient tests')) {
            t = t + "Outpatient tests I ordered include " + combineItemsFromButtons('outpatient tests') +". ";
          }
          t = t + "";
          t = t + "";
          
          navigator.clipboard.writeText(t);
          document.getElementById("text").innerHTML = t;
          
        }
        
        function isAnyChecked(name) {
          var ele = document.getElementsByName(name);
          for (let i = 0; i < ele.length; i++) {
            if (ele[i].checked) {
              return(true);
            }
          }
          return(false);
        }
        
        function combineItemsFromButtons(name) {
          var ele = document.getElementsByName(name);
          console.log("in combineItemsFromButtons");
          console.log("ele",ele);
          var list = [];
          for (let i = 0; i < ele.length; i++) {
            if (ele[i].checked) {
              list.push(ele[i].value);
            }
          }
          console.log("list",list);
          var t = list[0];
          for (let i = 1; i<list.length-1; i++) {
            t = t + ", "+ list[i];
          }
          if (list.length>1) {
            t = t + " and " + list[list.length-1];
          }
          return(t);
        }
      </script>

  </body>
</html>
